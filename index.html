<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis XV Fernanda Freyre Z√∫√±iga</title>

    <!-- Meta tags para redes sociales -->
    <meta property="og:title" content="Mis XV Fernanda Freyre Z√∫√±iga">
    <meta property="og:description" content="¬°Te invito a celebrar conmigo este d√≠a tan especial!">
    <meta property="og:image" content="https://invitadigitales.github.io/FernandaFreyre/f.png">
    <meta property="og:url" content="https://invitadigitales.github.io/FernandaFreyre/">
    <meta property="og:type" content="website">

    <!-- CSS Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flexslider@2.7.2/flexslider.css">
    <link rel="stylesheet" href="awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.css">

    <link rel="stylesheet" type="text/css" href="util.css">
    <link rel="stylesheet" type="text/css" href="filter.css">
    <link rel="stylesheet" type="text/css" href="styles.css">

<!-- lightGallery CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/css/lightgallery-bundle.min.css">

</head>

<body>
    <div class="content">



        <div class="pst_relative w_100 overflow_hidden">

      
            <div class="pst_absolute toppx_min_180 leftpx_min_100  zdex_2">
                <img class="hpx_300 esepjo_x animate_wind" src="nubes1.png">
            </div>


            <img class="pst_absolute toppx_150 leftpx_min_70 wpx_200 zdex_2 animate_wind" src="flo.png">

            <img class="pst_absolute toppx_min_70 rightpx_min_40 wpx_250 zdex_2 animate_wind" src="ojas1.png">
            <img class="pst_absolute toppx_70 rightpx_min_1 hpx_220 zdex_2 animate_wind" src="mune.png">

        
            <div class="pst_relative zdex_4">
                <div class="font_urbanist fspx_15 line_height_22 m_20 max_wpx_300">
                    Hoy hace 15 a√±os mis padres daban gracias a Dios por mi vida, hoy yo le doy gracias a Dios por tenerlos conmigo, y con la bendici√≥n de Dios y el amor que mi familia me ha brindado, me siento feliz de llegar a este d√≠a tan especial.
                </div>
                <center>
                    <h1 class="font_charm fspx_20 m_0 mt_25">Mis 15 a√±os</h1>
                    <h1 class="font_satisfy fspx_40 m_0 mt_20 ">Fernanda <br> Freyre Z√∫√±iga</h1>
                </center>
                <center>
                    <h1 class="font_charm fspx_20 m_0 mt_20">MIS PAP√ÅS</h1>
                    <h1 class="font_paris fspx_25 m_0 mt_15">Hans Freyre Mart√≠nez</h1>
                    <h1 class="font_paris fspx_25 m_0">Brenda A. Z√∫√±iga Guti√©rrez</h1>
                </center>
            </div>



            <img class="pst_absolute toppx_280 rightpx_min_100 wpx_220 zdex_2 animate_wind" src="flo.png">
            
            <div class="pst_absolute toppx_750 rightpx_min_70 zdex_2 animate_wind  "> <div class="rotate_50"><img class="pst_relative  wpx_200 espejo_x" src="flo.png"></div> </div>


            <div class="pst_absolute toppx_300 leftpx_min_80 zdex_2  rotate_60"> <img class="pst_relative animate_wind wpx_200" src="flo.png"> </div>
            <div class="pst_absolute toppx_750 leftpx_min_80 zdex_2  rotate_10"> <img class="pst_relative animate_wind wpx_200" src="flo.png"> </div>

            
            <img class="pst_absolute toppx_400 leftpx_min_50 wpx_250 zdex_2 animate_wind" src="torre.png">

            
            <div class="pst_relative zdex_4">


                <div class="d_iflex w_100 jc_center ai_center mt_30">
            
                    <div class="text_center br_y2 px_10 mr_10">
                        <h1 class="font_charm fspx_25 m_0">S√°bado</h1>
                    </div>
  
    
                    <div class="text_center">
                        <h1 class="font_charm fspx_25 m_0">Febrero</h1>
                        <h1 class="font_satisfy fspx_70 m_0 ">28</h1>
                    </div>
    
                    <div class="text_center br_y2 px_10 ml_10">
                        <h1 class="font_charm fspx_25 m_0">3:00pm</h1>
                    </div>
                </div>


            </div>

            <div class="pst_absolute rightpx_min_70 zdex_2 animate_wind"> <div class="rotate_10"><img class="pst_relative  wpx_200 espejo_x" src="flo.png"></div> </div>


            <div class="pst_relative zdex_4">
         
                <center>
                    <h1 class="font_charm fspx_20 m_0 mt_20">MIS PADRINOS</h1>
                    <h1 class="font_paris fspx_25 m_0 mt_15">Sergio I. Freyre Mart√≠nez</h1>
                    <h1 class="font_paris fspx_25 m_0">Ali K. Freyre Mart√≠nez</h1>
                </center>
            </div>



            <div class="text-center mt_30">
                <h1 class="font_charm fspx_20 m_0 mt_20">FALTAN :</h1>
                <div id="countdown"></div>
            </div>


        </div>






        <button id="btnQr" class="d-none"></button>
        <div class="bg_red_true">
            <center class="m_0a d_block max_wpx_700 color_black py_40">
                <div class="px_20">
                    <img src="tomaQr.png" class="w_100 max_wpx_150">
                </div>
                <button href="#" class="font_paris fspx_30 my_btn bg_white py_5 px_20 rounded color_black d_block w_100 my_20 text_shadow_dark no_link"
                        data-bs-toggle="modal" data-bs-target="#PaseModaQR" id="btnQr">
                    <i class="fa fa-camera-retro mr_10" aria-hidden="true"></i><span>Foto QR</span>
                </button>
            </center>
        </div>
        <!-- Modal -->
        <div class="modal fade" id="PaseModaQR">
          <div class="modal-dialog modal-lg">
            <div class="text_right mb_15" style="pointer-events: auto;">
                <button class="my_btn bg_red_true color_white rounded " data-bs-dismiss="modal" aria-label="Close">
                    <i class="material-icons p_5">close</i>
                </button>
            </div>
            <div class="modal-content bg_transparent">
                <div class="rounded" id="map1">
                    <div class="pase-xv">
                        <video id="camara" style="width: 100%; height: auto;" autoplay playsinline></video>
                        <div class="contenido-pase" id="watch_scaneo">
                            <p class="mensaje-inv">Escanea el c√≥digo QR para la foto.</p>
                        </div>
                    </div>  
                </div>
            </div>
          </div>
        </div>





        <div class="bgimg_patron bg_size_80 mb_30" >
            <center class="m_0a d_block max_wpx_700 color_black py_30">
                <h3 class="font_paris fspx_40 m_0">Mis Fotos</h3>
            </center>
            <div class="flexslider m_0">
              <ul class="slides">
                <li><img src="f1.jpg" /></li>
                <li><img src="f2.jpg" /></li>
                <li><img src="f3.jpg" /></li>
              </ul>
            </div>
        </div>
  




        <div class="pst_relative w_100 overflow_hidden" id="acces">



            <div class="pst_absolute toppx_100 leftpx_min_200 zdex_2  rotate_250">
                <img class="pst_relative animate_wind wpx_400" src="nubes1.png">
            </div>
            <img class="pst_absolute toppx_10 rightpx_min_100 wpx_250 zdex_2 animate_wind" src="plantas1.png">
      

            <img class="pst_absolute toppx_280 rightpx_min_100 wpx_220 zdex_2 animate_wind" src="flo.png">
            
            <div class="pst_absolute toppx_750 rightpx_min_70 zdex_2 animate_wind  "> <div class="rotate_50"><img class="pst_relative  wpx_200 espejo_x" src="flo.png"></div> </div>


            <div class="pst_absolute toppx_300 leftpx_min_80 zdex_2  rotate_20"> <img class="pst_relative animate_wind wpx_200" src="flo.png"> </div>
            <div class="pst_absolute toppx_150 leftpx_min_80 zdex_2  rotate_10"> <img class="pst_relative animate_wind wpx_200" src="flo.png"> </div>
            <div class="pst_absolute toppx_750 leftpx_min_80 zdex_2  rotate_20"> <img class="pst_relative animate_wind wpx_200" src="flo.png"> </div>

            <center>
                <img class="wpx_200 zdex_2" src="grafica3.svg">
            </center>

            <div class="pst_relative zdex_4">
                <center>
                    <h1 class="font_charm fspx_20 m_0 mt_20">TEMPLO</h1>
                    <div class="font_urbanist fspx_15 line_height_18 max_wpx_300">
                        Capilla del Sal√≥n de<br> Eventos Sociales Karsof
                    </div>
                    <a class="cur_pointer no_link" href="https://maps.app.goo.gl/5VFzZessoh3crBsb7">
                        <img class="max_wpx_80" src="location.png">
                        <h1 class=" m_0 font_quattrocento fspx_15 line_height_25 color_black">(clic para ver en Maps)</h1>
                    </a>
          
                    <h1 class="font_charm fspx_20 m_0 mt_20">RECEPCION</h1>
                    <h1 class="font_charm fspx_20 m_0">Salon Karsof</h1>
                    <div class="font_urbanist fspx_15 line_height_18 max_wpx_200">
                        Calle Juan C Doria, 42171 Ixcuinquitlapilco, Hgo.
                    </div>
                    <a class="cur_pointer no_link" href="https://maps.app.goo.gl/5VFzZessoh3crBsb7">
                        <img class="max_wpx_80" src="location.png">
                        <h1 class=" m_0 font_quattrocento fspx_15 line_height_25 color_black">(clic para ver en Maps)</h1>
                    </a>
               
           
                    <div class="m_0a d_block mb_40">
                        <div class="px_50 mt_20 color_black">
                            <h3 class="font_paris fspx_50 m_0">Regalos</h3>
                            <h3 class="font_urbanist fspx_15  max_wpx_300 m_0">El regalo es opcional, la asistencia obligatoria. Si deseas tener un detalle conmigo, una lluvia de sobres ser√° bien recibida.</h3>
                        </div>
                    </div>
                </center>

            </div>


        </div>


     


        <div class="pst_relative zdex_10 d_none" id="no_acces" onclick="ShowModal()">
            <div class="pst_relative bg_white py_50 px_20 text_center color_black">
               <h1 class="font_bold text_center fspx_20 m_0 color_red text_uppercase">La presente invitaci√≥n<br> no garantiza acceso al evento.</h1>
            </div>
        </div>




        <div class="pst_relative zdex_10 mb_40" id="acces">
            <img class="pst_absolute top_0 right_0 zdex_20 w_100" src="border3.svg">
            <div class="pst_relative bg_olivo py_70 px_20 text_center color_white">

               <h1 class="m_0 font_airthay fspx_70 line_height_40  color_golden">Confirmar <br> Asistencia</h1><br>
               <h1 class=" m_0 font_quattrocento fspx_20 line_height_25">¬øNos acompa√±as?</h1><br>
               <a href="https://api.whatsapp.com/send?phone=+527751610983&text=Hola%2C%20confirmo%20mi%20asistencia%20a%20tu%20evento"  class="no_link color_white">               
                    <img class="max_wpx_80 filter_invert" src="love.png">
                    <h1 class=" m_0 font_quattrocento fspx_15 line_height_25">Pulsa en el sobre</h1>
                </a>
            </div>
            <img class="pst_absolute bottompx_min_5 right_0 zdex_20 w_100 rotate_180" src="border3.svg">
        </div>
        

        <div class="pst_relative w_100 overflow_hidden">
   
            <center>
                <div class="m_0a d_block mb_40">
                    <div class="px_50 mt_20 color_black">
                        <h3 class="font_paris fspx_50 m_0">Nota!</h3>
                        <h3 class="font_urbanist fspx_15  max_wpx_300 m_0">Para garantizar la comodidad de todos nuestros invitados, agradecemos respetar el n√∫mero de pases asignados en esta invitaci√≥n.</h3>
                    </div>
                </div>
            </center>
        </div>
    

        <div id="gallery" class="gallery"></div>

        <!-- Footer -->
        <footer class="bd-footer pb-4">
            <div class="container-fluid pb-4">
                <div class="row align-items-center py-4">

                    <div class="col-12 text-center mb-3 mb-md-0">
                       <p class="font_chewy mb-0 fs-6">¬© 2025 Todos los derechos reservados</p>
                       <a href="https://invitadigitales.github.io/mx/" class="font_chewy mb-0 fs-6 no_link color_black">
                          <img src="net.svg" alt="Instagram" class="footer-icon filter_invert">
                          <span>invitadigitales.github.io/mx<span>
                        </a>
                    </div>

                    <div class="col-12">
                        <div class="d-flex justify-content-center gap-2">
                            <div class="footer-links font_chewy">
                                <a href="https://www.facebook.com/invitasdigital/" class="d-flex align-items-center justify-content-center fs-6 ">
                                    <img src="facebook.svg" alt="Facebook" class="footer-icon filter_invert">
                                    <span>InvitaDigitales</span>
                                </a>
                            </div>
                            <div class="footer-links font_chewy">
                                <a href="https://www.instagram.com/inbitadigitales/" class="d-flex align-items-center justify-content-center fs-6">
                                    <img src="instagram.svg" alt="Instagram" class="footer-icon filter_invert">
                                    <span>InbitaDigitales</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>





        <div class="pst_fixed zdex_9999 p_30" id="controls">
            <ul class="m_0 p_0 liststyle_none">
                <li id="sound">
                    <img src="sound_mute.svg" class="wpx_35 cur_pointer">
                </li>

            </ul>
        </div>
    </div>





    <!-- MINIDASH -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <form class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Login</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Ingresa key</label>
                        <input type="password" class="form-control" name="key" placeholder="##########">
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="Login()">Ingresar</button>
                </div>
            </div>
        </form>
    </div>




<!-- Scripts -->
<script src="controller.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flexslider@2.7.2/jquery.flexslider-min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/countdown/2.6.0/countdown.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
<script src="https://unpkg.com/qr-scanner/qr-scanner.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastify-js/1.12.0/toastify.min.js"></script>

<!-- Primero cargar JS de lightGallery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/lightgallery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/plugins/thumbnail/lg-thumbnail.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/2.7.2/plugins/zoom/lg-zoom.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
const API_URL = 'https://www.ztart.mx/';
const SUPABASE_URL = 'https://edgommnlktiidfbcvxhu.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVkZ29tbW5sa3RpaWRmYmN2eGh1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3NDIwODcsImV4cCI6MjA3ODMxODA4N30.K5zdBMVCt65O-EEqEu-HKFdMIcUreJeE9YPWkYxCyog';
const SUPABASE_BUCKET = "fotos1";



var audio = new Audio('audio.mp3');
audio.loop = true;
audio.volume = 0.5;


const API = "https://www.ztart.mx/";
const CLIENTE_ID = "12";


var targetDate = new Date("Feb 28, 2026 08:00:00").getTime();
var countdownTimer = countdown(
    targetDate,
    function(ts) {
        var countdownText = `
            <div class="time-container">
                <span>${ts.days}</span>
                <p>D√≠as</p>
            </div>
            <div class="time-container">
                <span>${ts.hours}</span>
                <p>Horas</p>
            </div>
            <div class="time-container">
                <span>${ts.minutes}</span>
                <p>Minutos</p>
            </div>
            <div class="time-container">
                <span>${ts.seconds}</span>
                <p>Segundos</p>
            </div>
        `;

        document.getElementById("countdown").innerHTML = countdownText;
    },
    countdown.DAYS | countdown.HOURS | countdown.MINUTES | countdown.SECONDS
);




$('.flexslider').flexslider({
    animation: "fade",
    slideshow: true,
    slideshowSpeed: 1500,
    animationSpeed: 600,
    pauseOnHover: false, 
    controlNav: true,   
    directionNav: true

});







let muted = false;
$('#sound').click(() => {

    muted = !muted;
    if (muted) {
        audio.play();
    } else {
        audio.pause();
    }
    $('#sound').find('img').attr('src', muted ? 'sound.svg' : 'sound_mute.svg');

});



document.addEventListener('DOMContentLoaded', function() {

    floatingController.register('#controls', '.content', {
        width: 80,
        customPosition: (element, container, breakpoint) => {
            const rect = container.getBoundingClientRect();
            element.style.right = rect.left + 'px';
            element.style.bottom = '0px';
        }
    });

});



























class UrlParams {  constructor() { this.params = new URLSearchParams(window.location.search); }  get(key) { return this.params.get(key); } }
const url = new UrlParams();
var invitado = url.get('invitado');
if(invitado!=null){
    var link = `${API}show?cliente_id=${CLIENTE_ID}&familia=${invitado}&r=${Math.random()}`;
    function procesarRespuesta(data) {
        var data = JSON.parse(data);
        if (data.message == false) {
            window.location.href = "./";
        } else {
            $("#txt_famlia").html(toTitleCase(data.message.familia));
            var n = data.message.num_invitados;
            var str = "";
            if (n > 1) {
                str = str + n + " personas";
            } else {
                str = str + n + " persona";
            }
            $("#txt_personas").html(str);
            console.log(data.message);
        }
    }
    fetch(link)
    .then(response => response.text())
    .then(data => procesarRespuesta(data))
    .catch(error => {
        console.error('Error en la petici√≥n:', error);
        window.location.href = "./";
    });
}else{
    $("*#acces").addClass("d_none");
    $("*#no_acces").removeClass("d_none");
}
function ShowModal(){
     $('#exampleModal').modal('show');
}
async function Login(){
    var formData = $('#exampleModal form');
    var serialize = formData.serialize();
    var dataObj = formData.serializeArray();
    var url = `${API}pase_login?cliente_id=${CLIENTE_ID}&clave=${dataObj[0].value}`;
    
    function procesarRespuesta(data) {
        if (data == 'error') {
            Toastify({
                text: "Error en la clave",
                duration: 1000,
                backgroundColor: "#F44336"
            }).showToast();
        }
        
        if (data == 'exito') {
            var all = `${API}/pase_all?cliente_id=${CLIENTE_ID}&r=${Math.random()}`;
            
            function procesarRespuestaAll(data) {
                $("#exampleModal").html(data);
            }
            
            fetch(all)
                .then(response => response.text())
                .then(data => {
                    procesarRespuestaAll(data);
                    console.log('Respuesta procesada exitosamente');
                })
                .catch(error => {
                    console.error('Error al cargar los datos:', error);
                });
        }
    }
    fetch(url)
        .then(response => response.text())
        .then(data => procesarRespuesta(data))
        .catch(error => {
            console.error('Error en la petici√≥n de login:', error);
            Toastify({
                text: "Error de conexi√≥n",
                duration: 1000,
                backgroundColor: "#F44336"
            }).showToast();
        });
}
function addinvitado(){
    const familia = document.getElementById('familia').value.trim().toLowerCase();
    const personas = document.getElementById('personas').value.trim();
    if (familia === '') {
        Toastify({
            text: "La familia no puede ser vacio",
            duration: 1000,
            backgroundColor: "#F44336"
        }).showToast();
        return false;
    }
    if (personas === '') {
        Toastify({
            text: "El n√∫mero de personas no puede ser vacio",
            duration: 1000,
            backgroundColor: "#F44336"
        }).showToast();
        return false;
    }
    if (isNaN(personas) || personas <= 0) {
        Toastify({
            text: "El n√∫mero de personas debe ser un n√∫mero v√°lido mayor a 0",
            duration: 1000,
            backgroundColor: "#F44336"
        }).showToast();
        return false;
    }
    const tabla = document.querySelector('table');
    const tbody = tabla.querySelector('tbody');
    let textoEncontrado = false;
    if (tbody.textContent.includes('Agrega invitados en la parte de abajo')) {
        textoEncontrado = true;
    }
    if (textoEncontrado) {
        tbody.innerHTML = ''; // Limpiar
    }
    let FEncontrado = false;
    if (tbody.textContent.includes(familia)) {
        FEncontrado = true;
    }
    if (FEncontrado) {
        Toastify({
            text: "La familia ya esta agregada",
            duration: 1000,
            backgroundColor: "#F44336"
        }).showToast();
        return false;
    }
    tbody.innerHTML += `
        <tr data-familia="${familia}">
            <td>${familia}</td>
            <td>${personas}</td>
            <td class="text_center">
                <button type="button" class="btn btn-primary p_5" onclick="compartirWat('${familia}')"><span class="material-icons">reply</span></button>
                <button type="button" class="btn btn-danger p_5" onclick="deleteFam('${familia}')"><span class="material-icons">delete</span></button>
            </td>
        </tr>
    `;
    Toastify({
        text: "Agregando ",
        duration: 1000,
        backgroundColor: "#4CAF50"
    }).showToast();
    document.getElementById('familia').value = '';
    document.getElementById('personas').value = '';
    var url = `${API}pase_update?cliente_id=${CLIENTE_ID}&tipo=1&familia=${familia}&personas=${personas}&r=${Math.random()}`;
    function procesarRespuesta(data) {
        console.log('Invitado agregado exitosamente');
    }
    fetch(url)
        .then(response => response.text())
        .then(data => procesarRespuesta(data))
        .catch(error => {
            console.error('Error al agregar invitado:', error);
            Toastify({
                text: "Error al guardar en el servidor",
                duration: 1000,
                backgroundColor: "#F44336"
            }).showToast();
        });
}
function deleteFam(familia){
    document.querySelector('[data-familia="'+familia+'"]').remove();
    const tabla = document.querySelector('table');
    const tbody = tabla.querySelector('tbody');
    const totalTr = tbody.querySelectorAll('tr').length
    if(totalTr < 1){
        tbody.innerHTML += `
            <tr>
                <td class="text_center" colspan="3">Agrega invitados en la parte de abajo</td>
            </tr>
        `;
    }
    Toastify({
        text: "Borrado ",
        duration: 1000,
        backgroundColor: "#4CAF50"
    }).showToast();

    var url = `${API}pase_update?cliente_id=${CLIENTE_ID}&tipo=0&familia=${familia}&r=${Math.random()}`;
    
    function procesarRespuesta(data) {
        console.log('Invitado borrado exitosamente');
    }
    
    fetch(url)
        .then(response => response.text())
        .then(data => procesarRespuesta(data))
        .catch(error => {
            console.error('Error al borrar invitado:', error);
            Toastify({
                text: "Error al eliminar del servidor",
                duration: 1000,
                backgroundColor: "#F44336"
            }).showToast();
        });
}
function compartirWat(familia){
    const boton = document.createElement('button');
    boton.id = 'miBoton';
    boton.className = 'd_none';
    boton.textContent = 'Compartir WhatsApp';
    document.body.appendChild(boton);
    
    // Codificar la familia para evitar problemas con espacios
    const familiaCodeada = encodeURIComponent(familia);
    const mensaje = "https://invitadigitales.github.io/FernandaFreyre/?invitado=" + familiaCodeada;
    const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(mensaje)}`;
    
    boton.addEventListener('click', function() {
        window.open(whatsappUrl, '_blank');
        boton.remove();
    });
    boton.click();
}
function toTitleCase(str) {
    return str
        .split(' ')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
        .join(' ');
}



























const video = document.getElementById("camara");
const canvas = document.getElementById("preview");
const fotoPreview = document.getElementById("fotoPreview");
const btnQr = document.getElementById("btnQr");
let toastActivo = false;
function mostrarToast(mensaje, color = "#F44336") {
    if (toastActivo) return; // ya hay un toast activo
    toastActivo = true;
    Toastify({
        text: mensaje,
        duration: 1000,
        backgroundColor: color,
        close: true,
        onClick: function(){}
    }).showToast();
    setTimeout(() => {
        toastActivo = false;
    }, 1000);
}
const scanner = new QrScanner(video, qrCode => {
    //scanner.stop();
    if ($('#watch_scaneo').is(':visible')) {
        console.log('El elemento es visible');
        if (qrCode === 'invdigital') {
            window.location.href = 'foto.html';
        } else {
            mostrarToast("QR invalido");
        }
    }
    $('#PaseModaQR').modal('hide');
});

btnQr.onclick = () => {
    const ctx = canvas.getContext("2d");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    ctx.drawImage(video, 0, 0);
};
navigator.mediaDevices.getUserMedia({ video: { facingMode: { exact: "environment" } } })
.then(stream => {
    video.srcObject = stream;
    scanner.start();
})
.catch(err => {
    console.error("No se pudo abrir la c√°mara trasera:", err);
});
















const gallery = document.getElementById('gallery');

// Inicializa LightGallery
const galleryInstance = lightGallery(gallery, {
    plugins: [lgThumbnail, lgZoom],
    speed: 500,
    thumbnail: true,
    download: true,
    zoom: true
});

// Funci√≥n para listar fotos
function listarFotos() {
    const url = `${API_URL}/fotos?cliente_id=${CLIENTE_ID}&SUPABASE_BUCKET=${SUPABASE_BUCKET}&SUPABASE_URL=${SUPABASE_URL}&SUPABASE_KEY=${SUPABASE_KEY}&r=${Math.random()}`;

    fetch(url)
        .then(res => res.json())
        .then(data => {
            console.log("Listado de fotos:", data);

            gallery.innerHTML = "";

            data.forEach(fotoUrl => {
                const a = document.createElement('a');
                a.href = fotoUrl;           // LightGallery usa href
                a.dataset.src = fotoUrl;    // compatibilidad
                a.style.display = "inline-block";
                const img = document.createElement('img');
                img.src = fotoUrl;
                img.style.width = "150px";
                img.style.height = "150px";
                img.style.objectFit = "cover";
                a.appendChild(img);
                gallery.appendChild(a);
            });

            // Refresca LightGallery para reconocer los nuevos elementos
            galleryInstance.refresh();
        })
        .catch(err => {
            console.error("Error al obtener fotos:", err);
            alert("Error al obtener fotos: " + err);
        });
}

// Evento para agregar el bot√≥n cada vez que se abre la galer√≠a
gallery.addEventListener('lgAfterOpen', () => {
    const toolbar = document.querySelector('.lg-toolbar');
    if (!toolbar) return;

    // Eliminar bot√≥n viejo si existe
    const oldBtn = document.getElementById('lg-delete-modal');
    if (oldBtn) oldBtn.remove();

    // Crear bot√≥n nuevo
    const btn = document.createElement('button');
    btn.id = 'lg-delete-modal';
    btn.innerHTML = 'üóëÔ∏è';
    btn.style.cssText = `
        background:black;
        color:#fff;
        border:none;
        padding:8px 12px;
        border-radius:0px;
        cursor:pointer;
        font-size:18px;
        margin-left:8px;
    `;
    toolbar.appendChild(btn);

    btn.onclick = function() {
        const slides = document.querySelectorAll('.lg-item');
        let idx = 0;
        slides.forEach((slide, i) => {
            if (slide.classList.contains('lg-current')) idx = i;
        });

        Swal.fire({
            title: 'Ingresa la clave para eliminar la foto',
            input: 'password',
            inputPlaceholder: 'Clave',
            showCancelButton: true,
            confirmButtonText: 'Eliminar',
            cancelButtonText: 'Cancelar',
            inputValidator: (value) => {
                if (!value) return 'Debes ingresar una clave';
                if (value !== 'clave123') return 'Clave incorrecta';
            }
        }).then(result => {
            if (result.isConfirmed) {
                eliminarFoto(document.querySelectorAll('#gallery a')[idx].href,
                             document.querySelectorAll('#gallery a')[idx]);

                // Cierre seguro del modal
                setTimeout(() => {


                    galleryInstance.closeGallery();

                }, 100);
            }
        });
    };
});

// Funci√≥n para eliminar foto
function eliminarFoto(fotoUrl, container) {
    const fileName = fotoUrl.split('/').pop();
    const deleteUrl = `${API_URL}/fotos?cliente_id=${CLIENTE_ID}&file_name=${fileName}&SUPABASE_BUCKET=${SUPABASE_BUCKET}&SUPABASE_URL=${SUPABASE_URL}&SUPABASE_KEY=${SUPABASE_KEY}`;

    fetch(deleteUrl, {
        method: 'DELETE',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            cliente_id: CLIENTE_ID,
            file_name: fileName,
            SUPABASE_BUCKET,
            SUPABASE_KEY
        })
    })
    .then(res => res.json())
    .then(data => {
        console.log("Foto eliminada:", data);
        container.style.transition = 'opacity 0.3s, transform 0.3s';
        container.style.opacity = '0';
        container.style.transform = 'scale(0.8)';
        setTimeout(() => container.remove(), 300);
    })
    .catch(err => {
        console.error("Error al eliminar foto:", err);
        alert('Error al eliminar la foto: ' + err);
    });
}
// Cargar fotos al inicio
listarFotos();



</script>
</body>
</html>